(function(){'use strict';var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)},n="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ba(){ba=function(){};n.Symbol||(n.Symbol=ca)}var da=0;function ca(a){return"jscomp_symbol_"+(a||"")+da++}
function ea(){ba();var a=n.Symbol.iterator;a||(a=n.Symbol.iterator=n.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&aa(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return fa(this)}});ea=function(){}}function fa(a){var b=0;return ga(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})}function ga(a){ea();a={next:a};a[n.Symbol.iterator]=function(){return this};return a}function ha(a){ea();var b=a[Symbol.iterator];return b?b.call(a):fa(a)}
function ia(a){for(var b,d=[];!(b=a.next()).done;)d.push(b.value);return d}function ja(a,b){ea();a instanceof String&&(a+="");var d=0,c={next:function(){if(d<a.length){var e=d++;return{value:b(e,a[e]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c}
function ka(a,b){if(b){var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&aa(d,a,{configurable:!0,writable:!0,value:b})}}ka("Array.prototype.keys",function(a){return a?a:function(){return ja(this,function(a){return a})}});ka("Math.cosh",function(a){if(a)return a;var b=Math.exp;return function(a){a=Number(a);return(b(a)+b(-a))/2}});
ka("Array.prototype.fill",function(a){return a?a:function(a,d,c){var b=this.length||0;0>d&&(d=Math.max(0,b+d));if(null==c||c>b)c=b;c=Number(c);0>c&&(c=Math.max(0,b+c));for(d=Number(d||0);d<c;d++)this[d]=a;return this}});ka("Number.EPSILON",function(){return Math.pow(2,-52)});ka("Array.prototype.find",function(a){return a?a:function(a,d){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var g=b[f];if(a.call(d,g,f,b)){a=g;break a}}a=void 0}return a}});var la=this;
function ma(a,b){a=a.split(".");var d=la;a[0]in d||!d.execScript||d.execScript("var "+a[0]);for(var c;a.length&&(c=a.shift());)a.length||void 0===b?d[c]?d=d[c]:d=d[c]={}:d[c]=b}function na(a,b){function d(){}d.prototype=b.prototype;a.kb=b.prototype;a.prototype=new d;a.prototype.constructor=a;a.Ya=function(a,d,f){for(var c=Array(arguments.length-2),e=2;e<arguments.length;e++)c[e-2]=arguments[e];return b.prototype[d].apply(a,c)}};function q(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a}function r(){}var oa=0;function pa(a){this.message="Assertion failed. See /doc/errors/#"+a+" for details.";this.code=a;this.name="AssertionError"}q(pa,Error);var v="function"===typeof Object.assign?Object.assign:function(a,b){if(!a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var d=Object(a),c=1,e=arguments.length;c<e;++c){var f=arguments[c];if(void 0!==f&&null!==f)for(var g in f)f.hasOwnProperty(g)&&(d[g]=f[g])}return d};function qa(a){for(var b in a)delete a[b]};function ra(a){function b(b){var d=a.listener,e=a.na||a.target;a.pa&&sa(a);return d.call(e,b)}return a.oa=b}function ta(a,b,d,c){for(var e,f=0,g=a.length;f<g;++f)if(e=a[f],e.listener===b&&e.na===d)return c&&(e.deleteIndex=f),e}function ua(a,b){return(a=a.S)?a[b]:void 0}function w(a,b,d,c,e){var f,g=a.S;g||(g=a.S={});f=g;(g=f[b])||(g=f[b]=[]);(f=ta(g,d,c,!1))?e||(f.pa=!1):(f={na:c,pa:!!e,listener:d,target:a,type:b},a.addEventListener(b,ra(f)),g.push(f));return f}
function va(a,b,d,c){(a=ua(a,b))&&(d=ta(a,d,c,!0))&&sa(d)}function sa(a){if(a&&a.target){a.target.removeEventListener(a.type,a.oa);var b=ua(a.target,a.type);if(b){var d="deleteIndex"in a?a.deleteIndex:b.indexOf(a);-1!==d&&b.splice(d,1);if(!b.length){var b=a.target,d=a.type,c=ua(b,d);if(c){for(var e=0,f=c.length;e<f;++e)b.removeEventListener(d,c[e].oa),qa(c[e]);c.length=0;if(c=b.S)delete c[d],Object.keys(c).length||delete b.S}}}qa(a)}};function wa(){};function xa(a){this.type=a;this.target=null}xa.prototype.preventDefault=xa.prototype.stopPropagation=function(){this.Na=!0};function ya(){this.J={};this.B={};this.I={}}q(ya,wa);ya.prototype.addEventListener=function(a,b){var d=this.I[a];d||(d=this.I[a]=[]);-1===d.indexOf(b)&&d.push(b)};function za(a,b){var d="string"===typeof b?new xa(b):b;b=d.type;d.target=a;var c=a.I[b];if(c){b in a.B||(a.B[b]=0,a.J[b]=0);++a.B[b];for(var e=0,f=c.length;e<f&&!1!==c[e].call(a,d)&&!d.Na;++e);--a.B[b];if(!a.B[b]){d=a.J[b];for(delete a.J[b];d--;)a.removeEventListener(b,r);delete a.B[b]}}}
ya.prototype.removeEventListener=function(a,b){var d=this.I[a];d&&(b=d.indexOf(b),a in this.J?(d[b]=r,++this.J[a]):(d.splice(b,1),d.length||delete this.I[a]))};function x(){ya.call(this);this.ca=0}q(x,ya);x.prototype.b=function(){++this.ca;za(this,"change")};x.prototype.on=function(a,b,d){if(Array.isArray(a)){for(var c=a.length,e=Array(c),f=0;f<c;++f)e[f]=w(this,a[f],b,d);return e}return w(this,a,b,d)};x.prototype.once=function(a,b,d){if(Array.isArray(a)){for(var c=a.length,e=Array(c),f=0;f<c;++f)e[f]=w(this,a[f],b,d,!0);return e}return w(this,a,b,d,!0)};function y(a){x.call(this);this.ra||(this.ra=++oa);this.C={};void 0!==a&&Aa(this,a)}q(y,x);var Ba={};function Ca(a){return Ba.hasOwnProperty(a)?Ba[a]:Ba[a]="change:"+a}y.prototype.get=function(a){var b;this.C.hasOwnProperty(a)&&(b=this.C[a]);return b};y.prototype.set=function(a,b,d){d?this.C[a]=b:(d=this.C[a],this.C[a]=b,d!==b&&(b=Ca(a),za(this,new Da(b,a,d)),za(this,new Da("propertychange",a,d))))};function Aa(a,b){for(var d in b)a.set(d,b[d],void 0)}
function Da(a,b,d){xa.call(this,a);this.key=b;this.oldValue=d}q(Da,xa);function Ea(a,b,d,c,e){return e?(e[0]=a,e[1]=b,e[2]=d,e[3]=c,e):[a,b,d,c]}function Fa(a){return[(a[0]+a[2])/2,(a[1]+a[3])/2]};var Ga=function(){var a;"cosh"in Math?a=Math.cosh:a=function(a){a=Math.exp(a);return(a+1/a)/2};return a}();/*

 Latitude/longitude spherical geodesy formulae taken from
 http://www.movable-type.co.uk/scripts/latlong.html
 Licensed under CC-BY-3.0.
*/
function Ha(a){this.radius=a}Ha.prototype.offset=function(a,b,d){var c=a[1]*Math.PI/180;b/=this.radius;var e=Math.asin(Math.sin(c)*Math.cos(b)+Math.cos(c)*Math.sin(b)*Math.cos(d));return[180*(a[0]*Math.PI/180+Math.atan2(Math.sin(d)*Math.sin(b)*Math.cos(c),Math.cos(b)-Math.sin(c)*Math.sin(e)))/Math.PI,180*e/Math.PI]};function z(a){this.v=a.code;this.b=a.units;this.a=void 0!==a.extent?a.extent:null;this.c=void 0!==a.global?a.global:!1;this.g=!(!this.c||!this.a);var b=a.code,d=window.proj4;"function"==typeof d&&(b=d.defs(b),void 0!==b&&void 0===a.units&&(this.b=b.units))}z.prototype.H=function(){return this.a};var Ia={};var A={};function B(a,b,d){a=a.v;b=b.v;a in A||(A[a]={});A[a][b]=d}function Ja(a,b){var d;a in A&&b in A[a]&&(d=A[a][b]);return d};function Ka(a){La(a);a.forEach(function(b){a.forEach(function(a){b!==a&&B(b,a,Ma)})})}function Na(a){Ia[a.v]=a;B(a,a,Ma)}function La(a){var b=[];a.forEach(function(a){b.push(Na(a))})}function Oa(a){return function(b,d,c){var e=b.length;c=void 0!==c?c:2;d=void 0!==d?d:Array(e);var f,g;for(g=0;g<e;g+=c)for(f=a([b[g],b[g+1]]),d[g]=f[0],d[g+1]=f[1],f=c-1;2<=f;--f)d[g+f]=b[g+f];return d}}
function C(a){var b=null;if(a instanceof z)b=a;else if("string"===typeof a){var b=Ia[a]||null,d=window.proj4;b||"function"!=typeof d||void 0===d.defs(a)||(b=new z({code:a}),Na(b))}return b}function Pa(a,b){a=C(a);b=C(b);return Qa(a,b)}
function Qa(a,b){var d=a.v,c=b.v,e=Ja(d,c);if(!e){var f=window.proj4;if("function"==typeof f){var g=f.defs(d),m=f.defs(c);void 0!==g&&void 0!==m&&(g===m?Ka([b,a]):(f=f(c,d),e=f.forward,f=f.inverse,b=C(b),a=C(a),B(b,a,Oa(e)),B(a,b,Oa(f))),e=Ja(d,c))}}e||(e=Ra);return e}function Ra(a,b){if(void 0!==b&&a!==b){for(var d=0,c=a.length;d<c;++d)b[d]=a[d];a=b}return a}function Ma(a,b){if(void 0!==b){for(var d=0,c=a.length;d<c;++d)b[d]=a[d];a=b}else a=a.slice();return a}
function Sa(a,b,d){b=Pa(b,d);a=[a[0],a[1],a[0],a[3],a[2],a[1],a[2],a[3]];b(a,a,2);d=[a[0],a[2],a[4],a[6]];var c=[a[1],a[3],a[5],a[7]];a=Math.min.apply(null,d);b=Math.min.apply(null,c);d=Math.max.apply(null,d);c=Math.max.apply(null,c);return Ea(a,b,d,c,void 0)};function D(){y.call(this);this.ba=[Infinity,Infinity,-Infinity,-Infinity];this.da=-1}q(D,y);D.prototype.H=function(a){this.da!=this.ca&&(this.ba=this.O(this.ba),this.da=this.ca);var b=this.ba;a?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):a=b;return a};D.prototype.transform=function(a,b){this.D(Pa(a,b));return this};(function(){if(!("HTMLCanvasElement"in window))return!1;try{return document.createElement("CANVAS").getContext("2d")?!0:!1}catch(a){return!1}})();function E(a){y.call(this);this.f=void 0;this.a="geometry";this.c=this.D=null;w(this,Ca(this.a),this.g,this);void 0!==a&&(a instanceof D||!a?this.set(this.a,a):Aa(this,a))}q(E,y);E.prototype.clone=function(){var a=new E(v({},this.C));Ta(a,this.a);var b=this.get(this.a);b&&(b=b.clone(),a.set(a.a,b));(b=this.D)&&a.setStyle(b);return a};E.prototype.O=function(){this.b()};E.prototype.g=function(){this.c&&(sa(this.c),this.c=null);var a=this.get(this.a);a&&(this.c=w(a,"change",this.O,this));this.b()};
E.prototype.setStyle=function(a){if((this.D=a)&&"function"!==typeof a&&!Array.isArray(a))throw new pa(41);this.b()};function Ta(a,b){va(a,Ca(a.a),a.g,a);a.a=b;w(a,Ca(a.a),a.g,a);a.g()};function Ua(){this.a=this.G=null};function F(){D.call(this);this.layout="XY";this.c=2;this.a=null}q(F,D);function Va(a){var b;"XY"==a?b=2:"XYZ"==a||"XYM"==a?b=3:"XYZM"==a&&(b=4);return b}F.prototype.O=function(a){var b=this.a,d=this.a.length,c=this.c;a=Ea(Infinity,Infinity,-Infinity,-Infinity,a);for(var e=0;e<d;e+=c){var f=a,g=b[e],m=b[e+1];f[0]=Math.min(f[0],g);f[1]=Math.min(f[1],m);f[2]=Math.max(f[2],g);f[3]=Math.max(f[3],m)}return a};function G(a,b,d){a.c=Va(b);a.layout=b;a.a=d}
function I(a,b,d,c){if(b)d=Va(b);else{for(b=0;b<c;++b)if(d.length)d=d[0];else{a.layout="XY";a.c=2;return}d=d.length;var e;2==d?e="XY":3==d?e="XYZ":4==d&&(e="XYZM");b=e}a.layout=b;a.c=d}F.prototype.D=function(a){this.a&&(a(this.a,this.a,this.c),this.b())};
F.prototype.rotate=function(a,b){var d=this.a;if(d){var c=d.length,e=this.c,f=d?d:[],g=Math.cos(a);a=Math.sin(a);var m=b[0];b=b[1];for(var h=0,k=0;k<c;k+=e){var l=d[k]-m,p=d[k+1]-b;f[h++]=m+l*g-p*a;f[h++]=b+l*a+p*g;for(l=k+2;l<k+e;++l)f[h++]=d[l]}d&&f.length!=h&&(f.length=h);this.b()}};
F.prototype.scale=function(a,b,d){var c=b;void 0===c&&(c=a);var e=d;e||(e=Fa(this.H()));if(d=this.a){b=d.length;for(var f=this.c,g=d?d:[],m=e[0],e=e[1],h=0,k=0;k<b;k+=f){var l=d[k]-m,p=d[k+1]-e;g[h++]=m+a*l;g[h++]=e+c*p;for(l=k+2;l<k+f;++l)g[h++]=d[l]}d&&g.length!=h&&(g.length=h);this.b()}};function Wa(a,b,d,c){var e,f;e=0;for(f=d.length;e<f;++e){var g=d[e],m;for(m=0;m<c;++m)a[b++]=g[m]}return b}function Xa(a,b,d,c,e){e=e?e:[];var f=0,g,m;g=0;for(m=d.length;g<m;++g)b=Wa(a,b,d[g],c),e[f++]=b;e.length=f;return e};function Ya(a,b){F.call(this);this.g(a,b)}q(Ya,F);Ya.prototype.clone=function(){var a=new Ya(null);G(a,this.layout,this.a.slice());a.b();return a};Ya.prototype.g=function(a,b){a?(I(this,b,a,1),this.a||(this.a=[]),this.a.length=Wa(this.a,0,a,this.c)):G(this,"XY",null);this.b()};(function(){var a={},b={s:a};(function(d){if("object"===typeof a&&"undefined"!==typeof b)b.s=d();else{var c;"undefined"!==typeof window?c=window:"undefined"!==typeof global?c=global:"undefined"!==typeof self?c=self:c=this;c.gb=d()}})(function(){return function c(a,b,g){function f(l,h){if(!b[l]){if(!a[l]){var k="function"==typeof require&&require;if(!h&&k)return k(l,!0);if(e)return e(l,!0);h=Error("Cannot find module '"+l+"'");throw h.code="MODULE_NOT_FOUND",h;}h=b[l]={s:{}};a[l][0].call(h.s,function(b){var c=
a[l][1][b];return f(c?c:b)},h,h.s,c,a,b,g)}return b[l].s}for(var e="function"==typeof require&&require,k=0;k<g.length;k++)f(g[k]);return f}({1:[function(a,b,f){a=a("./processor");f.Ua=a},{"./processor":2}],2:[function(a,b){function c(a){var b=!0;try{new ImageData(10,10)}catch(u){b=!1}return function(c){var f=c.buffers,e=c.meta,g=c.width,l=c.height,h=f.length,t=f[0].byteLength;if(c.imageOps){t=Array(h);for(c=0;c<h;++c){var k=t,m=c,p;p=new Uint8ClampedArray(f[c]);var kb=g,u=l;p=b?new ImageData(p,kb,
u):{data:p,width:kb,height:u};k[m]=p}g=a(t,e).data}else{g=new Uint8ClampedArray(t);l=Array(h);k=Array(h);for(c=0;c<h;++c)l[c]=new Uint8ClampedArray(f[c]),k[c]=[0,0,0,0];for(f=0;f<t;f+=4){for(c=0;c<h;++c)m=l[c],k[c][0]=m[f],k[c][1]=m[f+1],k[c][2]=m[f+2],k[c][3]=m[f+3];c=a(k,e);g[f]=c[0];g[f+1]=c[1];g[f+2]=c[2];g[f+3]=c[3]}}return g.buffer}}function e(a,b){var f=Object.keys(a.Ha||{}).map(function(b){return"var "+b+" = "+a.Ha[b].toString()+";"}).concat(["var __minion__ = ("+c.toString()+")(",a.Ma.toString(),
");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),f=URL.createObjectURL(new Blob(f,{type:"text/javascript"})),f=new Worker(f);f.addEventListener("message",b);return f}function m(a,b){var f=c(a.Ma);return{postMessage:function(a){setTimeout(function(){b({data:{buffer:f(a),meta:a.meta}})},0)}}}function h(a){this.V=!!a.eb;var b;0===a.Pa?b=0:this.V?b=1:b=a.Pa||1;var c=[];if(b)for(var f=
0;f<b;++f)c[f]=e(a,this.ka.bind(this,f));else c[0]=m(a,this.ka.bind(this,0));this.R=c;this.la=[];this.P=0;this.w={};this.W=null}var k=a("./util").Ja;h.prototype.destroy=function(){for(var a in this)this[a]=null;this.xa=!0};h.prototype.ya=function(){if(0===this.P&&0<this.la.length){var a=this.W=this.la.shift(),b=a.inputs[0].width,c=a.inputs[0].height,f=a.inputs.map(function(a){return a.data.buffer}),e=this.R.length;this.P=e;if(1===e)this.R[0].postMessage({buffers:f,meta:a.Ia,imageOps:this.V,width:b,
height:c},f);else for(var g=4*Math.ceil(a.inputs[0].data.length/4/e),h=0;h<e;++h){for(var k=h*g,t=[],m=0,$b=f.length;m<$b;++m)t.push(f[h].slice(k,k+g));this.R[h].postMessage({buffers:t,meta:a.Ia,imageOps:this.V,width:b,height:c},t)}}};h.prototype.ka=function(a,b){this.xa||(this.w[a]=b.data,--this.P,0===this.P&&this.Aa())};h.prototype.Aa=function(){var a=this.W,b=this.R.length,c,f;if(1===b)c=new Uint8ClampedArray(this.w[0].buffer),f=this.w[0].meta;else{var e=a.inputs[0].data.length;c=new Uint8ClampedArray(e);
f=Array(e);for(var e=4*Math.ceil(e/4/b),g=0;g<b;++g){var h=g*e;c.set(new Uint8ClampedArray(this.w[g].buffer),h);f[g]=this.w[g].meta}}this.W=null;this.w={};a.Za(null,k(c,a.inputs[0].width,a.inputs[0].height),f);this.ya()};b.s=h},{"./util":3}],3:[function(a,b,f){var c=!0;try{new ImageData(10,10)}catch(h){c=!1}var e=document.createElement("canvas").getContext("2d");f.Ja=function(a,b,f){if(c)return new ImageData(a,b,f);b=e.createImageData(b,f);b.data.set(a);return b}},{}]},{},[1])(1)})})();(function(){var a={},b={s:a};(function(d){if("object"===typeof a&&"undefined"!==typeof b)b.s=d();else{var c;"undefined"!==typeof window?c=window:"undefined"!==typeof global?c=global:"undefined"!==typeof self?c=self:c=this;c.hb=d()}})(function(){return function c(a,b,g){function f(h,k){if(!b[h]){if(!a[h]){var m="function"==typeof require&&require;if(!k&&m)return m(h,!0);if(e)return e(h,!0);k=Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k;}k=b[h]={s:{}};a[h][0].call(k.s,function(b){var c=
a[h][1][b];return f(c?c:b)},k,k.s,c,a,b,g)}return b[h].s}for(var e="function"==typeof require&&require,k=0;k<g.length;k++)f(g[k]);return f}({1:[function(a,b){function c(a,b,f,g,u){f=f||0;g=g||a.length-1;for(u=u||m;g>f;){if(600<g-f){var h=g-f+1,k=b-f+1,l=Math.log(h),p=.5*Math.exp(2*l/3),l=.5*Math.sqrt(l*p*(h-p)/h)*(0>k-h/2?-1:1);c(a,b,Math.max(f,Math.floor(b-k*p/h+l)),Math.min(g,Math.floor(b+(h-k)*p/h+l)),u)}h=a[b];k=f;p=g;e(a,f,b);for(0<u(a[g],h)&&e(a,f,g);k<p;){e(a,k,p);k++;for(p--;0>u(a[k],h);)k++;
for(;0<u(a[p],h);)p--}0===u(a[f],h)?e(a,f,p):(p++,e(a,p,g));p<=b&&(f=p+1);b<=p&&(g=p-1)}}function e(a,b,c){var f=a[b];a[b]=a[c];a[c]=f}function m(a,b){return a<b?-1:a>b?1:0}b.s=c},{}],2:[function(a,b){function c(a,b){if(!(this instanceof c))return new c(a,b);this.X=Math.max(4,a||9);this.ja=Math.max(2,Math.ceil(.4*this.X));b&&this.za(b);this.clear()}function e(a,b){m(a,0,a.children.length,b,a)}function m(a,b,c,f,e){e||(e=W(null));e.h=Infinity;e.i=Infinity;e.l=-Infinity;e.o=-Infinity;for(var g;b<c;b++)g=
a.children[b],h(e,a.j?f(g):g);return e}function h(a,b){a.h=Math.min(a.h,b.h);a.i=Math.min(a.i,b.i);a.l=Math.max(a.l,b.l);a.o=Math.max(a.o,b.o)}function k(a,b){return a.h-b.h}function l(a,b){return a.i-b.i}function p(a){return(a.l-a.h)*(a.o-a.i)}function u(a){return a.l-a.h+(a.o-a.i)}function hb(a,b){return a.h<=b.h&&a.i<=b.i&&b.l<=a.l&&b.o<=a.o}function ib(a,b){return b.h<=a.l&&b.i<=a.o&&b.l>=a.h&&b.o>=a.i}function W(a){return{children:a,height:1,j:!0,h:Infinity,i:Infinity,l:-Infinity,o:-Infinity}}
function jb(a,b,c,f,e){for(var g=[b,c],h;g.length;)c=g.pop(),b=g.pop(),c-b<=f||(h=b+Math.ceil((c-b)/f/2)*f,Zb(a,h,b,c,e),g.push(b,h,h,c))}b.s=c;var Zb=a("quickselect");c.prototype={all:function(){return this.fa(this.data,[])},search:function(a){var b=this.data,c=[],f=this.u;if(!ib(a,b))return c;for(var e=[],g,h,k,m;b;){g=0;for(h=b.children.length;g<h;g++)k=b.children[g],m=b.j?f(k):k,ib(a,m)&&(b.j?c.push(k):hb(a,m)?this.fa(k,c):e.push(k));b=e.pop()}return c},load:function(a){if(!a||!a.length)return this;
if(a.length<this.ja){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this.ha(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this.ma(this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),this.ia(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this.ia(a,this.data.height-1);return this},clear:function(){this.data=W([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,f=this.u(a),
e=[],g=[],h,k,m,l;c||e.length;){c||(c=e.pop(),k=e[e.length-1],h=g.pop(),l=!0);if(c.j){a:{m=a;var t=c.children,p=b;if(p){for(var H=0;H<t.length;H++)if(p(m,t[H])){m=H;break a}m=-1}else m=t.indexOf(m)}if(-1!==m){c.children.splice(m,1);e.push(c);this.wa(e);break}}l||c.j||!hb(c,f)?k?(h++,c=k.children[h],l=!1):c=null:(e.push(c),g.push(h),h=0,k=c,c=c.children[0])}return this},u:function(a){return a},Y:k,Z:l,toJSON:function(){return this.data},fa:function(a,b){for(var c=[];a;)a.j?b.push.apply(b,a.children):
c.push.apply(c,a.children),a=c.pop();return b},ha:function(a,b,c,f){var g=c-b+1,h=this.X,k;if(g<=h)return k=W(a.slice(b,c+1)),e(k,this.u),k;f||(f=Math.ceil(Math.log(g)/Math.log(h)),h=Math.ceil(g/Math.pow(h,f-1)));k=W([]);k.j=!1;k.height=f;var g=Math.ceil(g/h),h=g*Math.ceil(Math.sqrt(h)),m,l,p;for(jb(a,b,c,h,this.Y);b<=c;b+=h)for(l=Math.min(b+h-1,c),jb(a,b,l,g,this.Z),m=b;m<=l;m+=g)p=Math.min(m+g-1,l),k.children.push(this.ha(a,m,p,f-1));e(k,this.u);return k},va:function(a,b,c,f){for(var e,g,h,k,m,
l,t,H;;){f.push(b);if(b.j||f.length-1===c)break;t=H=Infinity;e=0;for(g=b.children.length;e<g;e++)h=b.children[e],m=p(h),l=(Math.max(h.l,a.l)-Math.min(h.h,a.h))*(Math.max(h.o,a.o)-Math.min(h.i,a.i))-m,l<H?(H=l,t=m<t?m:t,k=h):l===H&&m<t&&(t=m,k=h);b=k||b.children[0]}return b},ia:function(a,b,c){var f=this.u;c=c?a:f(a);var f=[],e=this.va(c,this.data,b,f);e.children.push(a);for(h(e,c);0<=b;)if(f[b].children.length>this.X)this.Ba(f,b),b--;else break;this.sa(c,f,b)},Ba:function(a,b){var c=a[b],f=c.children.length,
g=this.ja;this.ta(c,g,f);f=this.ua(c,g,f);f=W(c.children.splice(f,c.children.length-f));f.height=c.height;f.j=c.j;e(c,this.u);e(f,this.u);b?a[b-1].children.push(f):this.ma(c,f)},ma:function(a,b){this.data=W([a,b]);this.data.height=a.height+1;this.data.j=!1;e(this.data,this.u)},ua:function(a,b,c){var f,e,g,h,k,l,t;k=l=Infinity;for(f=b;f<=c-b;f++)e=m(a,0,f,this.u),g=m(a,f,c,this.u),h=Math.max(0,Math.min(e.l,g.l)-Math.max(e.h,g.h))*Math.max(0,Math.min(e.o,g.o)-Math.max(e.i,g.i)),e=p(e)+p(g),h<k?(k=h,
t=f,l=e<l?e:l):h===k&&e<l&&(l=e,t=f);return t},ta:function(a,b,c){var f=a.j?this.Y:k,e=a.j?this.Z:l,g=this.ga(a,b,c,f);b=this.ga(a,b,c,e);g<b&&a.children.sort(f)},ga:function(a,b,c,f){a.children.sort(f);f=this.u;var e=m(a,0,b,f),g=m(a,c-b,c,f),k=u(e)+u(g),l,p;for(l=b;l<c-b;l++)p=a.children[l],h(e,a.j?f(p):p),k+=u(e);for(l=c-b-1;l>=b;l--)p=a.children[l],h(g,a.j?f(p):p),k+=u(g);return k},sa:function(a,b,c){for(;0<=c;c--)h(b[c],a)},wa:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?
0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():e(a[b],this.u)},za:function(a){var b=["return a"," - b",";"];this.Y=new Function("a","b",b.join(a[0]));this.Z=new Function("a","b",b.join(a[1]));this.u=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}}},{quickselect:1}]},{},[2])(2)})})();function Za(a,b,d){if(a.nodeType==Node.CDATA_SECTION_NODE||a.nodeType==Node.TEXT_NODE)b?d.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):d.push(a.nodeValue);else for(a=a.firstChild;a;a=a.nextSibling)Za(a,b,d);return d}function $a(){var a=J;return function(b,d){b=a.call(this,b,d);void 0!==b&&d[d.length-1].push(b)}}function K(a){return function(b,d){var c=a.call(this,b,d);if(void 0!==c){d=d[d.length-1];b=b.localName;var e;b in d?e=d[b]:e=d[b]=[];e.push(c)}}}
function L(a){return function(b,d){var c=a.call(this,b,d);void 0!==c&&(d[d.length-1][b.localName]=c)}}function M(a){var b=ab,d={},c,e;c=0;for(e=b.length;c<e;++c)d[b[c]]=a;return d}function N(a,b,d,c){c.push(a);for(a=d.firstElementChild;a;a=a.nextElementSibling)d=b[a.namespaceURI],void 0!==d&&(d=d[a.localName])&&d.call(void 0,a,c);return c.pop()};try{new MouseEvent("click",{buttons:1})}catch(a){};function O(a,b){F.call(this);this.g(a,b)}q(O,F);O.prototype.clone=function(){var a=new O(null);G(a,this.layout,this.a.slice());a.b();return a};O.prototype.O=function(a){var b=this.a,d=b[0],b=b[1];return Ea(d,b,d,b,a)};O.prototype.g=function(a,b){if(a){I(this,b,a,0);this.a||(this.a=[]);var d=b=this.a,c=0,e,f;e=0;for(f=a.length;e<f;++e)d[c++]=a[e];b.length=c}else G(this,"XY",null);this.b()};function bb(a,b){F.call(this);this.f=[];this.g(a,b)}q(bb,F);bb.prototype.clone=function(){var a=new bb(null),b=this.f.slice();G(a,this.layout,this.a.slice());a.f=b;a.b();return a};bb.prototype.g=function(a,b){a?(I(this,b,a,2),this.a||(this.a=[]),a=Xa(this.a,0,a,this.c,this.f),this.a.length=a.length?a[a.length-1]:0):(a=this.f,G(this,"XY",null),this.f=a);this.b()};function cb(a){z.call(this,{code:a,units:"m",extent:db,global:!0,Qa:eb,bb:function(a,d){return a/Ga(d[1]/6378137)}})}q(cb,z);var P=6378137*Math.PI,db=[-P,-P,P,P],eb=[-180,-85,180,85],fb="EPSG:3857 EPSG:102100 EPSG:102113 EPSG:900913 urn:ogc:def:crs:EPSG:6.18:3:3857 urn:ogc:def:crs:EPSG::3857 http://www.opengis.net/gml/srs/epsg.xml#3857".split(" ").map(function(a){return new cb(a)});
function gb(a,b,d){var c=a.length;d=1<d?d:2;void 0===b&&(2<d?b=a.slice():b=Array(c));for(var e=0;e<c;e+=d){b[e]=P*a[e]/180;var f=6378137*Math.log(Math.tan(Math.PI*(a[e+1]+90)/360));f>P?f=P:f<-P&&(f=-P);b[e+1]=f}return b}function lb(a,b,d){var c=a.length;d=1<d?d:2;void 0===b&&(2<d?b=a.slice():b=Array(c));for(var e=0;e<c;e+=d)b[e]=180*a[e]/P,b[e+1]=360*Math.atan(Math.exp(a[e+1]/6378137))/Math.PI-90;return b};var mb=new Ha(6378137);function Q(a,b){z.call(this,{code:a,units:"degrees",extent:nb,Xa:b,global:!0,fb:ob,Qa:nb})}q(Q,z);var nb=[-180,-90,180,90],ob=Math.PI*mb.radius/180,pb=[new Q("CRS:84"),new Q("EPSG:4326","neu"),new Q("urn:ogc:def:crs:EPSG::4326","neu"),new Q("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Q("urn:ogc:def:crs:OGC:1.3:CRS84"),new Q("urn:ogc:def:crs:OGC:2:84"),new Q("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Q("urn:x-ogc:def:crs:EPSG:4326","neu")];Ka(fb);Ka(pb);pb.forEach(function(a){fb.forEach(function(b){B(a,b,gb);B(b,a,lb)})});function R(){return{restrict:"A",link:function(a,b,d){var c=a.$eval(d.ngeoSearch),e=a.$eval(d.ngeoSearchDatasets).slice();e.unshift(c);b.typeahead.apply(b,[].concat(e instanceof Array?e:ia(ha(e))));d=a.$eval(d.ngeoSearchListeners);var f=R.a(d);b.on("typeahead:open",function(){a.$apply(function(){f.open()})});b.on("typeahead:close",function(){a.$apply(function(){f.close()})});b.on("typeahead:cursorchange",function(b,c,d){a.$apply(function(){f.cursorchange(b,c,d)})});b.on("typeahead:select",function(b,
c,d){a.$apply(function(){f.select(b,c,d)})});b.on("typeahead:autocomplete",function(b,c,d){a.$apply(function(){f.autocomplete(b,c,d)})});b.on("typeahead:asyncreceive",function(c,d,e){a.$apply(function(){var a=b.data("tt-typeahead").menu._allDatasetsEmpty();f.datasetsempty(c,e,a)})})}}}
R.a=function(a){var b;a?b={open:a.open?a.open:r,close:a.close?a.close:r,cursorchange:a.cursorchange?a.cursorchange:r,datasetsempty:a.datasetsempty?a.datasetsempty:r,select:a.select?a.select:r,autocomplete:a.autocomplete?a.autocomplete:r}:b={open:r,close:r,cursorchange:r,datasetsempty:r,select:r,autocomplete:r};return b};R.module=angular.module("ngeoSearchDirective",[]);R.module.directive("ngeoSearch",R);function qb(){Ua.call(this)}q(qb,Ua);function rb(a){return"string"===typeof a?(a=JSON.parse(a))?a:null:null!==a?a:null};function S(a){D.call(this);this.a=a?a:null;sb(this)}q(S,D);function sb(a){var b,d;if(a.a)for(b=0,d=a.a.length;b<d;++b)w(a.a[b],"change",a.b,a)}S.prototype.clone=function(){var a=new S(null),b=this.a,d=[],c,e;c=0;for(e=b.length;c<e;++c)d.push(b[c].clone());if(a.a)for(b=0,c=a.a.length;b<c;++b)va(a.a[b],"change",a.b,a);a.a=d;sb(a);a.b();return a};
S.prototype.O=function(a){Ea(Infinity,Infinity,-Infinity,-Infinity,a);for(var b=this.a,d=0,c=b.length;d<c;++d){var e=a,f=b[d].H();f[0]<e[0]&&(e[0]=f[0]);f[2]>e[2]&&(e[2]=f[2]);f[1]<e[1]&&(e[1]=f[1]);f[3]>e[3]&&(e[3]=f[3])}return a};S.prototype.rotate=function(a,b){for(var d=this.a,c=0,e=d.length;c<e;++c)d[c].rotate(a,b);this.b()};S.prototype.scale=function(a,b,d){d||(d=Fa(this.H()));for(var c=this.a,e=0,f=c.length;e<f;++e)c[e].scale(a,b,d);this.b()};
S.prototype.D=function(a){var b=this.a,d,c;d=0;for(c=b.length;d<c;++d)b[d].D(a);this.b()};function tb(a,b){F.call(this);this.f=[];this.g(a,b)}q(tb,F);tb.prototype.clone=function(){var a=new tb(null),b=this.f.slice();G(a,this.layout,this.a.slice());a.f=b;a.b();return a};tb.prototype.g=function(a,b){a?(I(this,b,a,2),this.a||(this.a=[]),a=Xa(this.a,0,a,this.c,this.f),this.a.length=a.length?a[a.length-1]:0):(a=this.f,G(this,"XY",null),this.f=a);this.b()};function ub(a,b){F.call(this);this.g(a,b)}q(ub,F);ub.prototype.clone=function(){var a=new ub(null);G(a,this.layout,this.a.slice());a.b();return a};ub.prototype.g=function(a,b){a?(I(this,b,a,1),this.a||(this.a=[]),this.a.length=Wa(this.a,0,a,this.c)):G(this,"XY",null);this.b()};function vb(a,b){F.call(this);this.f=[];this.g(a,b)}q(vb,F);vb.prototype.clone=function(){for(var a=new vb(null),b=this.f.length,d=Array(b),c=0;c<b;++c)d[c]=this.f[c].slice();G(a,this.layout,this.a.slice());a.f=d;a.b();return a};
vb.prototype.g=function(a,b){if(a){I(this,b,a,3);this.a||(this.a=[]);b=this.a;var d=this.c,c=this.f,e=0,c=c?c:[],f=0,g,m;g=0;for(m=a.length;g<m;++g)e=Xa(b,e,a[g],d,c[f]),c[f++]=e,e=e[e.length-1];c.length=f;c.length?(a=c[c.length-1],this.a.length=a.length?a[a.length-1]:0):this.a.length=0}else a=this.f,G(this,"XY",null),this.f=a;this.b()};function wb(a){a=a?a:{};Ua.call(this);this.G=C(a.G?a.G:"EPSG:4326");a.A&&(this.a=C(a.A));this.b=a.geometryName}q(wb,qb);function xb(a,b){var d;if(a){a=(0,yb[a.type])(a);var c=b?C(b.A):null;b=b?C(b.F):null;var e;if(e=c&&b)c===b?e=!0:(e=c.b===b.b,e=c.v===b.v?e:Qa(c,b)===Ma&&e),e=!e;e?a instanceof D?d=a.transform(b,c):d=Sa(a,b,c):d=a}else d=null;return d}
var yb={Point:function(a){return new O(a.coordinates)},LineString:function(a){return new Ya(a.coordinates)},Polygon:function(a){return new bb(a.coordinates)},MultiPoint:function(a){return new ub(a.coordinates)},MultiLineString:function(a){return new tb(a.coordinates)},MultiPolygon:function(a){return new vb(a.coordinates)},GeometryCollection:function(a,b){a=a.geometries.map(function(a){return xb(a,b)});return new S(a)}};
function zb(a,b,d){b="Feature"===b.type?b:{type:"Feature",geometry:b};d=xb(b.geometry,d);var c=new E;a.b&&Ta(c,a.b);c.set(c.a,d);void 0!==b.id&&(c.f=b.id,c.b());b.properties&&Aa(c,b.properties);return c};function Ab(a,b,d,c,e,f){var g=new wb;a={remote:{url:a,prepare:function(a,b){b.url=b.url.replace("%QUERY",a);return b},transform:function(a){b&&(a={type:"FeatureCollection",features:a.features.filter(b)});var f=a,e={A:d,F:c};a=rb(f);var l;if(e){if(e.F)l=e.F;else if(l=rb(f).crs)if("name"==l.type)l=C(l.properties.name);else if("EPSG"==l.type)l=C("EPSG:"+l.properties.code);else throw new pa(36);else l=g.G;l={F:l,A:e.A}}e=v({F:g.G,A:g.a},l);if("FeatureCollection"===a.type){l=[];a=a.features;var m,f=0;
for(m=a.length;f<m;++f)l.push(zb(g,a[f],e))}else l=[zb(g,a,e)];return l}},datumTokenizer:r,queryTokenizer:Bloodhound.tokenizers.whitespace};e=v({},e||{});f=v({},f||{});e.remote&&(v(f,e.remote),delete e.remote);v(a,e);v(a.remote,f);return new Bloodhound(a)}Ab.module=angular.module("ngeoSearchCreategeojsonbloodhound",[]);Ab.module.value("ngeoSearchCreateGeoJSONBloodhound",Ab);if("function"==typeof proj4){proj4.defs("EPSG:21781","+proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +k_0=1 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs");var Bb=C("EPSG:21781"),Cb=[42E4,3E4,9E5,35E4];Bb.a=Cb;Bb.g=!(!Bb.c||!Cb)};function Db(a){var b=a||{},d=C("EPSG:21781"),c=b.targetProjection;a={remote:{url:"https://api3.geo.admin.ch/rest/services/api/SearchServer?type=locations&searchText=%QUERY",prepare:function(a,c){c.url=c.url.replace("%QUERY",a);void 0!==b.limit&&(c.url+="&limit="+b.limit);void 0!==b.origins&&(c.url+="&origins="+b.origins);return b.prepare?b.prepare(a,c):c},transform:function(a){return a.results.map(function(a){a=a.attrs;var b=new O([a.y,a.x]),f;f=/BOX\((.*?) (.*?),(.*?) (.*?)\)/g.exec(a.geom_st_box2d);
f=null!==f?[parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]),parseFloat(f[4])]:null;c&&(b.transform(d,c),null!==f&&(f=Sa(f,d,c)));a.geometry=b;a.bbox=f;b=a.label;a.label_no_html=b.replace(/<\/?[ib]>/g,"");f=/<b>(.*?)<\/b>/g.exec(b);a.label_simple=null!==f?f[1]:b;b=new E(a);b.f=a.featureId;b.b();return b})}},datumTokenizer:r,queryTokenizer:Bloodhound.tokenizers.whitespace};var e=v({},b.options||{}),f=v({},b.remoteOptions||{});e.remote&&(v(f,e.remote),delete e.remote);v(a,e);v(a.remote,f);return new Bloodhound(a)}
Db.module=angular.module("ngeoCreateLocationSearchBloodhound",[]);Db.module.value("ngeoCreateLocationSearchBloodhound",Db);var Eb=angular.module("ngeoSearchModule",[R.module.name,Ab.module.name,Db.module.name]);function Fb(a,b,d,c){var e,f;this.b=function(a){return!(2E7<a)};this.a=function(b){var f=a.defer();e&&e.abort();e=new FileReader;e.onload=function(a){f.resolve(a.target.result)};e.onerror=function(a){a=a.target.error;d.console.error("Reading file failed: ",a);f.reject({message:20==a.code?c("Operation canceled"):c("Read failed"),reason:a.message})};e.onprogress=function(a){f.notify(a)};e.readAsText(b);return f.promise};this.load=function(e,m){f&&f.resolve();f=m||a.defer();var g=a.defer();b.get(e,{timeout:f.promise}).then(function(a){g.resolve(a.data)},
function(a){d.console.error("Uploading file failed: ",a);g.reject({message:c("Upload failed"),reason:a})});return g.promise}}Fb.$inject=["$q","$http","$window","gettext"];var Gb=angular.module("ngeo.fileService",[]);Gb.service("ngeoFile",Fb);function Hb(a,b,d,c,e){return{restrict:"A",templateUrl:e,scope:{options:"=ngeoImportDndOptions"},link:function(f,e){var g=f.options;if(g&&"function"===typeof g.handleFileContent){f.handleFileContent=g.handleFileContent;e.click(function(){this.style.display="none"}).on("dragleave drop",function(){this.style.display="none"}).on("dragover dragleave drop",function(a){a.stopPropagation();a.preventDefault()}).on("drop",function(b){var e=b.originalEvent.dataTransfer.files;if(e&&0<e.length)c.a(e[0]).then(function(a){f.handleFileContent(a,
e[0])});else if(b.originalEvent.dataTransfer.types){var h=b.originalEvent.dataTransfer.getData("text/plain");if(g.isValidUrl(h))c.load(h).then(function(a){return f.handleFileContent(a,{url:h})})["catch"](function(b){a.alert(d.getString(b.message))});else a.alert(d.getString("Invalid URL")+h)}});var h=function(a){a.stopPropagation();a.preventDefault();a=a.originalEvent.dataTransfer.types||[];for(var b=0,c=a.length;b<c;++b)if(/(files|text\/plain)/i.test(a[b])){e.css("display","table");break}};b.on("dragenter",
h);var k=function(){return!1};b.on("dragstart",k);f.$on("$destroy",function(){b.off("dragEnter",h).off("dragstart",k)})}else e.remove()}}}Hb.$inject=["$window","$document","gettextCatalog","ngeoFile","ngeoImportDndTemplateUrl"];var Ib=angular.module("ngeo.importDndDirective",["gettext",Gb.name]);Ib.value("ngeoImportDndTemplateUrl",function(a,b){a=b.ngeoImportDndTemplateUrl;return void 0!==a?a:Jb+"/import/partials/import-dnd.html"});Ib.directive("ngeoImportDnd",Hb);function Kb(a,b,d,c){var e;return{restrict:"A",templateUrl:c,scope:{options:"=ngeoImportLocalOptions"},link:function(c,g){var f=c.options;if(f&&"function"===typeof f.handleFileContent){c.handleFileContent=c.options.handleFileContent;var h=function(){c.userMessage=b("Load local file");c.progress=0;c.fileReader=null};h();f=function(){g.find('input[type="file"]').click()};g.find("button.ngeo-import-browse").click(f);g.find("input.form-control[type=text][readonly]").click(f);g.find("input[type=file]").bind("change",
function(a){a.target.files&&0<a.target.files.length&&c.$apply(function(){c.files=a.target.files})});c.$watchCollection("files",function(){if(c.files&&0<c.files.length){var a=c.files[0];c.file=a;c.fileSize=a.size;c.isDropped&&c.handleFile()}});c.isLoading=function(){return 0<c.progress&&100>c.progress};c.isValid=function(a){return!a||d.b(a.size)};c.cancel=function(){c.fileReader&&(c.fileReader.abort(),c.fileReader=null)};c.handleFile=function(){c.file&&(c.loading=!0,c.userMessage=b("Reading file"),
a.cancel(e),d.a(c.file).then(function(a){c.fileReader=null;c.userMessage=b("Parsing file");return c.handleFileContent(a,c.file)}).then(function(){c.userMessage=b("Parsing succeeded")},function(a){c.userMessage=a.message},function(a){c.fileReader||(c.fileReader=a.target)}).finally(function(){c.fileReader=null;c.loading=!1;e=a(h,5E3)}))}}else g.remove()}}}Kb.$inject=["$timeout","gettext","ngeoFile","ngeoImportLocalTemplateUrl"];var Lb=angular.module("ngeo.importLocalDirective",[Gb.name]);
Lb.value("ngeoImportLocalTemplateUrl",function(a,b){a=b.ngeoImportLocalTemplateUrl;return void 0!==a?a:Jb+"/import/partials/import-local.html"});Lb.directive("ngeoImportLocal",Kb);function Mb(a,b,d,c,e){var f;return{restrict:"A",templateUrl:e,scope:{options:"=ngeoImportOnlineOptions"},link:function(e,m){var g=e.options;if(g&&"function"===typeof g.handleFileContent){e.handleFileContent=g.handleFileContent;var k=function(){e.userMessage=c("Connect");e.progress=0;e.loading=!1};k();var l=e.options.urls;l&&0<l.length&&!l[0].name&&(l=l.map(function(a){return{name:a,url:a}}));var p=m.find("input[name=url]").typeahead({hint:!0,highlight:!0,minLength:0},{name:"wms",displayKey:"name",
limit:500,source:function(a){return function(b,c){var d=[];if(b){var e=new RegExp(b,"i");a.forEach(function(a){e.test(a.name)&&d.push(a)})}else d=a;c(d)}}(l)}).on("typeahead:selected",function(a,b){p.typeahead("close");e.fileUrl=b.url;e.handleFileUrl();e.$digest()}),u=m.find(".tt-menu");m.find(".ngeo-import-open").on("mousedown",function(a){"none"==u.css("display")?(p.focus(),p.typeahead("val","")):p.blur();a.preventDefault()});e.$on("gettextLanguageChanged",function(){e.fileUrl&&/lang=/.test(e.fileUrl)&&
e.handleFileUrl()});e.cancel=function(){e.progress=0;e.canceler&&(e.canceler.resolve(),e.canceler=null)};e.isValid=function(a){return g.isValidUrl?g.isValidUrl(a):!0};e.handleFileUrl=function(){var h=e.fileUrl;g.transformUrl&&(h=g.transformUrl(h));e.canceler=a.defer();e.loading=!0;e.userMessage=c("Downloading file");b.cancel(f);d.load(h,e.canceler).then(function(a){e.canceler=null;return e.handleFileContent(a,{url:e.fileUrl})}).then(function(a){e.userMessage=a.message},function(a){e.userMessage=a.message}).finally(function(){e.canceler=
null;e.loading=!1;f=b(k,1E4)})}}else m.remove()}}}Mb.$inject=["$q","$timeout","ngeoFile","gettext","ngeoImportOnlineTemplateUrl"];var Nb=angular.module("ngeo.importOnlineDirective",[Gb.name,"gettext"]);Nb.value("ngeoImportOnlineTemplateUrl",function(a,b){a=b.ngeoImportOnlineTemplateUrl;return void 0!==a?a:Jb+"/import/partials/import-online.html"});Nb.directive("ngeoImportOnline",Mb);function Ob(a){return a.getAttributeNS("http://www.w3.org/1999/xlink","href")};function Pb(){}function Qb(a){var b=new Rb;return a instanceof Document?Sb(b,a):a instanceof Node?Tb(b,a):"string"===typeof a?(a=(new DOMParser).parseFromString(a,"application/xml"),Sb(b,a)):null};function T(a){if(a=/^\s*(true|1)|(false|0)\s*$/.exec(a))return void 0!==a[1]||!1}function U(a){a=Za(a,!1,[]).join("");return V(a)}function V(a){if(a=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(a))return parseFloat(a[1])}function Ub(a){a=Za(a,!1,[]).join("");return Vb(a)}function Vb(a){if(a=/^\s*(\d+)\s*$/.exec(a))return parseInt(a[1],10)}function J(a){return Za(a,!1,[]).join("").trim()};function Rb(){this.version=void 0}q(Rb,Pb);function Sb(a,b){for(b=b.firstChild;b;b=b.nextSibling)if(b.nodeType==Node.ELEMENT_NODE)return Tb(a,b);return null}function Tb(a,b){a.version=b.getAttribute("version").trim();return(a=N({version:a.version},Wb,b,[]))?a:null}function X(a,b){return N({},Xb,a,b)}function Yb(a,b){return N({},ac,a,b)}function bc(a,b){if(b=X(a,b))return a=[Vb(a.getAttribute("width")),Vb(a.getAttribute("height"))],b.size=a,b}function cc(a,b){return N([],dc,a,b)}
var ab=[null,"http://www.opengis.net/wms"],Wb=M({Service:L(function(a,b){return N({},ec,a,b)}),Capability:L(function(a,b){return N({},fc,a,b)})}),fc=M({Request:L(function(a,b){return N({},gc,a,b)}),Exception:L(function(a,b){return N([],hc,a,b)}),Layer:L(function(a,b){return N({},ic,a,b)})}),ec=M({Name:L(J),Title:L(J),Abstract:L(J),KeywordList:L(cc),OnlineResource:L(Ob),ContactInformation:L(function(a,b){return N({},jc,a,b)}),Fees:L(J),AccessConstraints:L(J),LayerLimit:L(Ub),MaxWidth:L(Ub),MaxHeight:L(Ub)}),
jc=M({ContactPersonPrimary:L(function(a,b){return N({},kc,a,b)}),ContactPosition:L(J),ContactAddress:L(function(a,b){return N({},lc,a,b)}),ContactVoiceTelephone:L(J),ContactFacsimileTelephone:L(J),ContactElectronicMailAddress:L(J)}),kc=M({ContactPerson:L(J),ContactOrganization:L(J)}),lc=M({AddressType:L(J),Address:L(J),City:L(J),StateOrProvince:L(J),PostCode:L(J),Country:L(J)}),hc=M({Format:$a()}),ic=M({Name:L(J),Title:L(J),Abstract:L(J),KeywordList:L(cc),CRS:K(J),EX_GeographicBoundingBox:L(function(a,
b){var d=N({},mc,a,b);if(d){a=d.westBoundLongitude;b=d.southBoundLatitude;var c=d.eastBoundLongitude,d=d.northBoundLatitude;if(void 0!==a&&void 0!==b&&void 0!==c&&void 0!==d)return[a,b,c,d]}}),BoundingBox:K(function(a){var b=[V(a.getAttribute("minx")),V(a.getAttribute("miny")),V(a.getAttribute("maxx")),V(a.getAttribute("maxy"))],d=[V(a.getAttribute("resx")),V(a.getAttribute("resy"))];return{crs:a.getAttribute("CRS"),extent:b,res:d}}),Dimension:K(function(a){return{name:a.getAttribute("name"),units:a.getAttribute("units"),
unitSymbol:a.getAttribute("unitSymbol"),"default":a.getAttribute("default"),multipleValues:T(a.getAttribute("multipleValues")),nearestValue:T(a.getAttribute("nearestValue")),current:T(a.getAttribute("current")),values:J(a)}}),Attribution:L(function(a,b){return N({},nc,a,b)}),AuthorityURL:K(function(a,b){if(b=X(a,b))return b.name=a.getAttribute("name"),b}),Identifier:K(J),MetadataURL:K(function(a,b){if(b=X(a,b))return b.type=a.getAttribute("type"),b}),DataURL:K(X),FeatureListURL:K(X),Style:K(function(a,
b){return N({},oc,a,b)}),MinScaleDenominator:L(U),MaxScaleDenominator:L(U),Layer:K(function(a,b){var d=b[b.length-1],c=N({},ic,a,b);if(c)return b=T(a.getAttribute("queryable")),void 0===b&&(b=d.queryable),c.queryable=void 0!==b?b:!1,b=Vb(a.getAttribute("cascaded")),void 0===b&&(b=d.cascaded),c.cascaded=b,b=T(a.getAttribute("opaque")),void 0===b&&(b=d.opaque),c.opaque=void 0!==b?b:!1,b=T(a.getAttribute("noSubsets")),void 0===b&&(b=d.noSubsets),c.noSubsets=void 0!==b?b:!1,(b=V(a.getAttribute("fixedWidth")))||
(b=d.fixedWidth),c.fixedWidth=b,(a=V(a.getAttribute("fixedHeight")))||(a=d.fixedHeight),c.fixedHeight=a,["Style","CRS","AuthorityURL"].forEach(function(a){a in d&&(c[a]=(c[a]||[]).concat(d[a]))}),"EX_GeographicBoundingBox BoundingBox Dimension Attribution MinScaleDenominator MaxScaleDenominator".split(" ").forEach(function(a){a in c||(c[a]=d[a])}),c})}),nc=M({Title:L(J),OnlineResource:L(Ob),LogoURL:L(bc)}),mc=M({westBoundLongitude:L(U),eastBoundLongitude:L(U),southBoundLatitude:L(U),northBoundLatitude:L(U)}),
gc=M({GetCapabilities:L(Yb),GetMap:L(Yb),GetFeatureInfo:L(Yb)}),ac=M({Format:K(J),DCPType:K(function(a,b){return N({},pc,a,b)})}),pc=M({HTTP:L(function(a,b){return N({},qc,a,b)})}),qc=M({Get:L(X),Post:L(X)}),oc=M({Name:L(J),Title:L(J),Abstract:L(J),LegendURL:K(bc),StyleSheetURL:L(X),StyleURL:L(X)}),Xb=M({Format:L(J),OnlineResource:L(Ob)}),dc=M({Keyword:$a()});function rc(a,b,d,c){function e(a,c,d){c.Name||(c.isInvalid=!0,c.Abstract=b("Invalid layer: missing name"));if(!c.isInvalid){c.wmsUrl=a.Service.OnlineResource;c.wmsVersion=a.version;c.id="WMS||"+c.wmsUrl+"||"+c.Name;var f;a:{f=d.v;if(c.BoundingBox)for(var g=0,l=c.BoundingBox.length;g<l;g++){var m=c.BoundingBox[g],u=m.crs||m.srs;if(u&&u.toUpperCase()==f.toUpperCase()){f=m.extent;break a}}if(g=c.EX_GeographicBoundingBox||c.LatLonBoundingBox)if(l=Sa(d.H(),f,"EPSG:4326"),m=[Infinity,Infinity,-Infinity,
-Infinity],l[0]<=g[2]&&l[2]>=g[0]&&l[1]<=g[3]&&l[3]>=g[1]&&(m[0]=l[0]>g[0]?l[0]:g[0],m[1]=l[1]>g[1]?l[1]:g[1],m[2]=l[2]<g[2]?l[2]:g[2],m[3]=l[3]<g[3]?l[3]:g[3]),m){f=Sa(m,"EPSG:4326",f);break a}f=void 0}c.extent=f;f=d.v;if(g="1.3.0"==a.version)g=c.CRS||c.SRS||[],g=!(-1!=g.indexOf(f.toUpperCase())||-1!=g.indexOf(f.toLowerCase()));g&&(c.useReprojection=!0,c.extent||(c.isInvalid=!0,c.Abstract=b("Invalid layer: outside the map")))}if(c.Layer){for(f=0;f<c.Layer.length;f++)e(a,c.Layer[f],d)||(c.Layer.splice(f,
1),f--);0==c.Layer.length&&(c.Layer=void 0)}if(!c.isInvalid||c.Layer)return c}return{restrict:"A",templateUrl:c,scope:{getCap:"=ngeoWmsGetCap",map:"=ngeoWmsGetCapMap",options:"=ngeoWmsGetCapOptions"},link:function(c){c.layers=[];c.options=c.options||{};c.$watch("getCap",function(f){var g;try{f=Qb(f)}catch(h){g=h}g||!f?(a.console.error("WMS GetCap parsing failed: ",g||f),c.userMsg=b("Parsing failed")):(c.limitations="",c.layers=[],c.options.layerSelected=null,c.options.layerHovered=null,f&&f.Service&&
f.Capability&&(f.Service.MaxWidth&&(c.limitations=d.getString("Maximum WMS size allowed")+" "+f.Service.MaxWidth+" * "+f.Service.MaxHeight),f.Capability.Layer&&(f=e(f,f.Capability.Layer,c.map.Ea().cb()))&&(c.layers=f.Layer||[f])))});c.addLayerSelected=function(){var b=c.options.layerSelected;if(b&&c.options.getOlLayerFromGetCapLayer){var e=d.getString("WMS layer added succesfully");try{var f=c.options.getOlLayerFromGetCapLayer(b);f&&c.map.Wa(f)}catch(k){a.console.error("Add layer failed:"+k),e=d.getString("WMS layer could not be added")+
" "+k.message}a.alert(e)}};c.getAbstract=function(){return d.getString((c.options.layerSelected||c.options.layerHovered||{}).Abstract)||""}}}}rc.$inject=["$window","gettext","gettextCatalog","ngeoWmsGetCapTemplateUrl"];var sc=angular.module("ngeo.wmsGetCapDirective",["gettext"]);sc.value("ngeoWmsGetCapTemplateUrl",function(a,b){a=b.ngeoWmsGetCapTemplateUrl;return void 0!==a?a:Jb+"/import/partials/wms-get-cap.html"});sc.directive("ngeoWmsGetCap",rc);function tc(a){var b=a.options;a.addPreviewLayer=function(d,c){d.stopPropagation();b.layerHovered=c;c.isInvalid||b.addPreviewLayer(a.map,c)};a.removePreviewLayer=function(d){d.stopPropagation();b.layerHovered=null;b.removePreviewLayer(a.map)};a.toggleLayerSelected=function(a,c){a.stopPropagation();b.layerSelected=b.layerSelected&&b.layerSelected.Name==c.Name?null:c}}tc.$inject=["$scope"];
function uc(a,b){return{restrict:"A",templateUrl:b,controller:"NgeoWmsGetCapItemDirectiveController",compile:function(b){var c=b.contents().remove(),d;return function(b,e){d||(d=a(c));d(b,function(a){e.append(a)});var f=e.find("> .ngeo-header-group"),g=f.find(".fa-plus"),k;f.find(".fa-zoom-in").on("click",function(a){a.stopPropagation();a:{var c=b.layer,d=b.map,e=c.extent;b.options.transformExtent&&(e=b.options.transformExtent(c.extent));a=d.Ea();var f=[d.l-d.h+1,d.o-d.i+1];if(c.ea&&e){var g=2834.64*
a.Da(e,f);if(g>c.ea){d=Fa(e);g/=c.ea;c=(e[2]-e[0])/g;e=(e[3]-e[1])/g;e=[d[0]-c/2,d[1]-e/2,d[0]+c/2,d[1]+e/2];if(e=b.options.transformExtent(e))e=a.$a(a.Da(e,f),0,-1),a.ib(d),a.jb(e);break a}}e&&a.ab(e,f)}});g.on("click",function(a){a.stopPropagation();g.toggleClass("fa-minus");k||(k=e.find("> .ngeo-child-group"));k.slideToggle()})}}}}uc.$inject=["$compile","ngeoWmsGetCapItemTemplateUrl"];var vc=angular.module("ngeo.wmsGetCapItemDirective",[]);
vc.value("ngeoWmsGetCapItemTemplateUrl",function(a,b){a=b.ngeoWmsGetCapItemTemplateUrl;return void 0!==a?a:Jb+"/import/partials/wms-get-cap-item.html"});vc.controller("NgeoWmsGetCapItemDirectiveController",tc);vc.directive("ngeoWmsGetCapItem",uc);var wc=angular.module("ngeo.import",[Gb.name,Ib.name,Lb.name,Nb.name,sc.name,vc.name]);var xc=angular.module("ngeo",[Eb.name,wc.name,"gettext","ui.date","floatThead"]),Jb="ngeomodule";ma("ngeo.AttributeType",{Ra:"date",Sa:"datetime",Ta:"geometry",Va:"select",TEXT:"text"});ma("ngeo.FeatureProperties",{ANGLE:"a",COLOR:"c",IS_CIRCLE:"l",IS_RECTANGLE:"r",IS_TEXT:"t",NAME:"n",OPACITY:"o",AZIMUT:"z",SHOW_MEASURE:"m",SIZE:"s",STROKE:"k"});ma("ngeo.FilterCondition",{AND:"&&",NOT:"!",OR:"||"});
ma("ngeo.GeometryType",{CIRCLE:"Circle",LINE_STRING:"LineString",MULTI_LINE_STRING:"MultiLineString",MULTI_POINT:"MultiPoint",MULTI_POLYGON:"MultiPolygon",POINT:"Point",POLYGON:"Polygon",RECTANGLE:"Rectangle",TEXT:"Text"});function yc(a){if(Error.captureStackTrace)Error.captureStackTrace(this,yc);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}na(yc,Error);yc.prototype.name="CustomError";function zc(a,b){for(var d=a.split("%s"),c="",e=Array.prototype.slice.call(arguments,1);e.length&&1<d.length;)c+=d.shift()+e.shift();return c+d.join("%s")};function Ac(a,b){b.unshift(a);yc.call(this,zc.apply(null,b));b.shift()}na(Ac,yc);Ac.prototype.name="AssertionError";function Bc(a,b){throw new Ac("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};xc.value("ngeoPopupTemplateUrl",function(a,b){a=b.ngeoPopupTemplateurl;return void 0!==a?a:"ngeo/popup.html"});function Cc(a){return{restrict:"A",templateUrl:a,link:function(a,d){d.addClass("popover");a.close=function(a){a&&(a.stopPropagation(),a.preventDefault());d.addClass("hidden")};a.$watch("open",function(a){d.css("display",a?"block":"none")})}}}Cc.$inject=["ngeoPopupTemplateUrl"];xc.directive("ngeoPopup",Cc);function Y(a,b,d,c){var e=this;this.scope=b.$new(!0);this.scope.$watch(function(){return e.scope.open},function(a){!a&&e.c&&e.g(function(){e.destroy()})});this.b=d;this.g=c;this.a=angular.element("<div ngeo-popup></div>");this.c=!1;a(this.a)(this.scope);angular.element(document.body).append(this.a)}Y.prototype.Ca=function(){return this.scope.open};Y.prototype.getOpen=Y.prototype.Ca;Y.prototype.M=function(a){this.scope.open=a};Y.prototype.setOpen=Y.prototype.M;
Y.prototype.destroy=function(){this.scope.$destroy();this.a.remove()};Y.prototype.destroy=Y.prototype.destroy;Y.prototype.N=function(a){a=this.b.trustAsHtml(a);this.scope.title=a};Y.prototype.setTitle=Y.prototype.N;Y.prototype.L=function(a,b){this.scope.content=b?this.b.trustAsHtml(a):a};Y.prototype.setContent=Y.prototype.L;Y.prototype.aa=function(a){a=this.b.trustAsHtml('<iframe src="'+a+'" width="100%" height="100%"></iframe>');this.L(a)};Y.prototype.setUrl=Y.prototype.aa;Y.prototype.U=function(a){this.a.width(a)};
Y.prototype.setWidth=Y.prototype.U;Y.prototype.T=function(a){this.a.height(a)};Y.prototype.setHeight=Y.prototype.T;Y.prototype.qa=function(a,b){this.U(a);this.T(b)};Y.prototype.setSize=Y.prototype.qa;Y.prototype.K=function(a){this.c=a};Y.prototype.setAutoDestroy=Y.prototype.K;Y.prototype.addClass=function(a){this.a.addClass(a)};Y.prototype.addClass=Y.prototype.addClass;
Y.prototype.open=function(a){a.url?this.aa(a.url):a.content?this.L(a.content):Bc('ngeo.Popup options requirest "url" or "content".');void 0!==a.autoDestroy&&this.K(a.autoDestroy);void 0!==a.cls&&this.addClass(a.cls);void 0!==a.height&&this.T(a.height);void 0!==a.title&&this.N(a.title);void 0!==a.width&&this.U(a.width);this.M(!0)};Y.prototype.open=Y.prototype.open;function Dc(a,b,d,c){return function(){return new Y(a,b,d,c)}}Dc.$inject=["$compile","$rootScope","$sce","$timeout"];
xc.factory("ngeoCreatePopup",Dc);var Ec=angular.module("app",["ngeo"]);function Z(a,b){this.b=a;this.a=b;$('[data-toggle="tooltip"]').tooltip({container:"body",trigger:"hover"})}Z.$inject=["$sce","ngeoCreatePopup"];Z.prototype.Oa=function(){var a=this.a();a.K(!0);a.N("Simple popup");var b=this.b.trustAsHtml("This is a simple 400x300 px popup.");a.L(b);a.U("400px");a.T("300px");a.M(!0)};Z.prototype.simplePopup=Z.prototype.Oa;
Z.prototype.Ga=function(){var a=this.a();a.K(!0);a.addClass("popup-with-iframe");a.N("Iframe popup");a.aa("http://geomapfish.org/");a.qa("400px","300px");a.M(!0)};Z.prototype.iframePopup=Z.prototype.Ga;
Z.prototype.Fa=function(){var a=this.a();a.K(!0);a.N("This is a popup with lots and lots of content and a very long title");var b=this.b.trustAsHtml("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla egetquam at ex euismod bibendum et eget enim. Nulla sodales tortor acsagittis aliquet. Ut malesuada quam vitae pulvinar porta. Nunc idmagna id risus malesuada elementum eget id purus. Curabitur vel augueblandit, faucibus nulla quis, consequat tellus. Phasellus commodo,tellus et vulputate ultricies, nulla libero ornare arcu, quisfermentum sem diam quis tellus. Aliquam ut sapien tristique, laciniaante et, lacinia arcu. Quisque sagittis eros at quam blanditgravida. Nulla sit amet enim semper, efficitur eros sit amet,porttitor libero. Fusce quis tellus est. Quisque ornare, ex egetluctus pharetra, nisl leo lobortis purus, sed tristique neque leo egetodio. Maecenas lobortis nisl ac magna mollis, ac pulvinar risusconvallis. Donec ullamcorper sollicitudin maximus. Quisque bibendumelit sit amet ultrices ornare. Donec aliquam felis id urna ultricesscelerisque.");a.L(b);
a.M(!0)};Z.prototype.heavyPopup=Z.prototype.Fa;Z.prototype.Ka=function(){var a=this.a(),b=this.b.trustAsHtml("This popup was opened using the <code>open</code> method.");a.open({autoDestroy:!0,content:b,height:"200px",title:'Opened with "open"',width:"300px"})};Z.prototype.openPopupWithContent=Z.prototype.Ka;Z.prototype.La=function(){this.a().open({autoDestroy:!0,cls:"popup-with-iframe",height:"300px",title:'Opened with "open" and "iframe"',url:"http://geomapfish.org/",width:"400px"})};
Z.prototype.openPopupWithUrl=Z.prototype.La;Ec.controller("MainController",Z);(function(){function a(a){a.put("ngeo/attributes.html",'<fieldset ng-disabled=attrCtrl.disabled> <div class=form-group ng-repeat="attribute in ::attrCtrl.attributes"> <div ng-if="attribute.type !== \'geometry\'"> <label class=control-label>{{ ::attribute.name | translate }} <span class=text-muted>{{::attribute.required ? "*" : ""}}</span></label> <div ng-switch=attribute.type> <select name={{::attribute.name}} ng-required=attribute.required ng-switch-when=select ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); class=form-control type=text> <option ng-repeat="attribute in ::attribute.choices" value="{{ ::attribute }}"> {{ ::attribute }} </option> </select> <input name={{::attribute.name}} ng-required=attribute.required ng-switch-when=date ui-date=attrCtrl.dateOptions ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); class=form-control type=text> <input name={{::attribute.name}} ng-required=attribute.required ng-switch-when=datetime ui-date=attrCtrl.dateOptions ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); class=form-control type=text> <input name={{::attribute.name}} ng-required=attribute.required ng-switch-default ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); class=form-control type=text> <div ng-show="form.$submitted || form[attribute.name].$touched"> <p class=text-danger ng-show=form[attribute.name].$error.required> {{\'This field is required\' | translate}} </p> </div> </div> </div> </div> </fieldset> ');
a.put("ngeo/popup.html",'<h4 class="popover-title ngeo-popup-title"> <span ng-bind-html=title></span> <button type=button class=close ng-click="open = false"> &times;</button> </h4> <div class=popover-content ng-bind-html=content></div> ');a.put("ngeomodule/import/partials/import-local.html",'<div class="input-group input-group-sm"> <input type=file name=file> <input class=form-control type=text readonly value="{{(file.name) ? file.name + \', \' + file.size/1000 + \' ko\' : \'\'}}" placeholder="{{\'No file\' | translate}}"> <span class=input-group-btn> <button type=button class="btn btn-default ngeo-import-browse" translate>Browse</button> </span> </div> <div ng-hide=isValid(file) class=ngeo-error translate>File too large</div> <div class=tabbable-footer> <button type=button class="btn btn-default btn-sm ngeo-load" ng-class="{\'btn-danger\': loading}" ng-disabled="!isValid(file) || (loading && !fileReader)" ng-click="loading ? cancel() : handleFile()"> <span>{{userMessage | translate}}</span> </button> </div> ');
a.put("ngeomodule/import/partials/import-dnd.html","<div translate>Drop file here</div> ");a.put("ngeo/filter.html",'<div class=dropdown> <a class="btn btn-link dropdown-toggle ngeo-filter-condition-button" type=button data-toggle=dropdown> <span class="glyphicon glyphicon-cog"></span> <span class=caret></span> </a> <ul class=dropdown-menu> <li class=ngeo-filter-condition-criteria-header translate>Criteria taken into account</li> <li ng-repeat="condition in ::filterCtrl.conditions"> <a href ng-click=filterCtrl.setCondition(condition)> <span ng-class="{\'ngeo-filter-condition-criteria-active\': condition.value == filterCtrl.datasource.filterCondition}" class="glyphicon glyphicon-ok ngeo-filter-condition-criteria"> </span> <span>{{::condition.text | translate}}</span> </a> </li> </ul> </div> <div ng-repeat="rule in filterCtrl.directedRules"> {{ rule.name }} </div> <hr ng-if=filterCtrl.directedRules.length> <div ng-repeat="rule in filterCtrl.customRules"> {{ rule.name }} </div> <div class=dropdown> <a class="btn btn-link dropdown-toggle" type=button data-toggle=dropdown> <span translate>+ Add a new criteria</span> <span class=caret></span> </a> <ul class=dropdown-menu> <li ng-repeat="attribute in ::filterCtrl.geometryAttributes"> <a href ng-click> <span translate>Spatial filter</span> </a> </li> <li role=presentation class=divider></li> <li ng-repeat="attribute in ::filterCtrl.otherAttributes"> <a href ng-click=filterCtrl.createAndAddCustomRule(attribute)> <span>{{::attribute.name | translate}}</span> </a> </li> </ul> </div> <a class="btn btn-link" type=button data-toggle=dropdown ng-click=filterCtrl.apply()> <span class="glyphicon glyphicon-ok"></span> <span translate>Apply</span> </a> ');
a.put("ngeo/scaleselector.html",'<div class="btn-group btn-block" ng-class="::{\'dropup\': scaleselectorCtrl.options.dropup}"> <button type=button class="btn btn-default dropdown-toggle" data-toggle=dropdown aria-expanded=false> <span ng-bind-html=scaleselectorCtrl.currentScale|ngeoScalify></span>&nbsp;<i class=caret></i> </button> <ul class="dropdown-menu btn-block" role=menu> <li ng-repeat="zoomLevel in ::scaleselectorCtrl.zoomLevels"> <a href ng-click=scaleselectorCtrl.changeZoom(zoomLevel) ng-bind-html=::scaleselectorCtrl.getScale(zoomLevel)|ngeoScalify> </a> </li> </ul> </div> ');
a.put("ngeomodule/import/partials/wms-get-cap-item.html",'<div class=ngeo-header-group ng-class="{\'ngeo-odd\': $odd, \'ngeo-invalid\': layer.isInvalid, \'ngeo-selected\': (options.layerSelected === layer)}" ng-mouseenter="addPreviewLayer($event, layer)" ng-mouseleave=removePreviewLayer($event) ng-click="toggleLayerSelected($event, layer)"> <button class="fa fa-zoom-in ngeo-btn" ng-disabled=!(layer.extent)></button> <button class="fa fa-plus" ng-hide=!(layer.Layer)></button> {{layer.Title}} </div> <ul class=ngeo-child-group ng-if=!!(layer.Layer)> <li ng-repeat="layer in layer.Layer | orderBy:\'Title\'"> <div ngeo-wms-get-cap-item></div> </li> </ul> ');
a.put("ngeo/grid.html",'<div class=ngeo-grid-table-container> <table float-thead=ctrl.floatTheadConfig ng-model=ctrl.configuration.data class="table table-bordered table-striped table-hover"> <thead class=table-header> <tr> <th ng-repeat="columnDefs in ctrl.configuration.columnDefs" ng-click=ctrl.sort(columnDefs.name)>{{columnDefs.name | translate}} <i ng-show="ctrl.sortedBy !== columnDefs.name" class="fa fa-fw"></i> <i ng-show="ctrl.sortedBy === columnDefs.name && ctrl.sortAscending === true" class="fa fa-caret-up"></i> <i ng-show="ctrl.sortedBy === columnDefs.name && ctrl.sortAscending === false" class="fa fa-caret-down"></i> </th> </tr> </thead> <tbody> <tr ng-repeat="attributes in ctrl.configuration.data" ng-class="[\'row-\' + ctrl.configuration.getRowUid(attributes), ctrl.configuration.isRowSelected(attributes) ? \'ngeo-grid-active\': \'\']" ng-click="ctrl.clickRow(attributes, $event)" ng-mousedown=ctrl.preventTextSelection($event)> <td ng-repeat="columnDefs in ctrl.configuration.columnDefs" ng-bind-html="attributes[columnDefs.name] | ngeoTrustHtml"></td> </tr> </tbody> </table> </div> ');
a.put("ngeomodule/import/partials/wms-get-cap.html",'<div class=ngeo-message>{{limitations}}</div> <div class=ngeo-container> <div class=ngeo-header ng-click="reverse = !reverse"> <label translate>Layer</label> <button class="pull-right fa" ng-class="{\'fa-sort-by-alphabet\': !reverse, \'fa-sort-by-alphabet-alt\': reverse}"></button> </div> <div class=ngeo-content> <ul> <li ng-repeat="layer in layers | orderBy:\'Title\':reverse"> <div ngeo-wms-get-cap-item></div> </li> </ul> </div> <div class="modal-backdrop fade in" ng-show="progress > 0 && progress < 100"> <div class="progress progress-striped active"> <div class=progress-bar style="width: 100%;"></div> </div> </div> </div> <div class=ngeo-descr> <label translate>Description</label> <textarea placeholder="{{\'description instructions\' | translate}}" class=form-control readonly>{{getAbstract()}}</textarea> <button type=button class="btn btn-default btn-sm ngeo-add" ng-disabled="(!options.layerSelected || options.layerSelected.isInvalid)" ng-click=addLayerSelected() translate>Add layer</button> </div> ');
a.put("ngeo/datepicker.html","<div class=ngeo-datepicker> <form name=dateForm class=ngeo-datepicker-form novalidate> <div ng-if=\"::datepickerCtrl.time.widget === 'datepicker'\"> <div class=ngeo-datepicker-start-date> <span ng-if=\"::datepickerCtrl.time.mode === 'range'\" translate>From:</span> <span ng-if=\"::datepickerCtrl.time.mode !== 'range'\" translate>Date:</span> <input name=sdate ui-date=datepickerCtrl.sdateOptions ng-model=datepickerCtrl.sdate required> </div> <div class=ngeo-datepicker-end-date ng-if=\"::datepickerCtrl.time.mode === 'range'\"> <span translate>To:</span> <input name=edate ui-date=datepickerCtrl.edateOptions ng-model=datepickerCtrl.edate required> </div> </div> </form> </div> ");
a.put("ngeomodule/import/partials/import-online.html",'<form class="form-group form-group-sm"> <input type=url name=url autocomplete=off placeholder="{{\'Choose or enter online resource URL\' | translate}}" ng-model=fileUrl required class=form-control> <div class="ngeo-import-open fa fa-collapse"></div> </form> <div class=tabbable-footer> <button type=button class="btn btn-default btn-sm" ng-class="{\'btn-danger\': canceler}" ng-disabled="!fileUrl || !isValid(fileUrl) || (loading && !canceler)" ng-click="loading ? cancel() : handleFileUrl()"> <span>{{userMessage | translate}}</span> </button> </div> ');
a.put("ngeo/layertree.html",'<span ng-if=::!layertreeCtrl.isRoot>{{::layertreeCtrl.node.name}}</span> <input type=checkbox ng-if="::layertreeCtrl.node && !layertreeCtrl.node.children" ng-model=layertreeCtrl.getSetActive ng-model-options="{getterSetter: true}"> <ul ng-if=::layertreeCtrl.node.children> <li ng-repeat="node in ::layertreeCtrl.node.children" ngeo-layertree=::node ngeo-layertree-notroot ngeo-layertree-map=layertreeCtrl.map ngeo-layertree-nodelayerexpr=layertreeCtrl.nodelayerExpr ngeo-layertree-listenersexpr=layertreeCtrl.listenersExpr> </li> </ul> ');
a.put("ngeo/colorpicker.html",'<table class=ngeo-colorpicker-palette> <tr ng-repeat="colors in ::ctrl.colors"> <td ng-repeat="color in ::colors" ng-click=ctrl.setColor(color) ng-class="{\'ngeo-colorpicker-selected\': color == ctrl.color}"> <div ng-style="::{\'background-color\': color}"></div> </td> </tr> </table> ')}a.$inject=["$templateCache"];xc.run(a)})();}).call(window);
//# sourceMappingURL=popupservice.js.map
